@using MusicGenMVC.Models
@model IEnumerable<SongItem>
@{
    var p = (GenerationParams)ViewBag.Params;
    var pageNum = (int)ViewBag.Page;      // use pageNum to avoid @page directive collision
    var size = (int)ViewBag.PageSize;
    var total = (int)ViewBag.Total;
}

<div class="d-flex flex-wrap gap-3" id="gal">
    @foreach (var s in Model)
    {
        <div class="card song-card" data-index="@s.Index">
            <img src="@Url.Action("Proxy","Media", new { url = s.CoverUrl })" alt="@s.Title" />
            <div class="card-body">
                <div class="fw-bold">@s.Title</div>
                <div class="text-muted">@s.Artist</div>
                <div class="small">@s.Album • @s.Genre</div>
                <div class="small">❤️ @s.Likes</div>
                <audio class="w-100 mt-1"
                       controls
                       src="/media/audio?lang=@p.Lang&seed=@p.Seed&page=@pageNum&index=@s.Index"></audio>
            </div>
        </div>
    }
</div>